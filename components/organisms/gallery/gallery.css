/**
 * Gallery Organism Component
 *
 * Description: Versatile grid-based gallery for images, portfolios, case studies, and blog posts.
 * Supports masonry layouts, lightbox modals, lazy loading, and category filtering.
 *
 * Marketing Context:
 * - Visual storytelling: Show products in action, real-world use cases
 * - Portfolio credibility: High-quality images signal professionalism (74% trust factor)
 * - Case studies: Show results, not just deliverables
 * - Lazy loading: Performance optimization (faster load = lower bounce)
 *
 * Variants:
 * - Layout: 2-column, 3-column, 4-column, masonry
 * - Style: default, overlay, minimal, cards
 * - Aspect ratio: square, landscape, portrait, auto
 *
 * Features:
 * - Responsive grid (1 col â†’ 2/3/4 cols)
 * - Masonry layout (varying heights)
 * - Image lazy loading
 * - Hover effects (overlay fade, zoom)
 * - Card integration for rich content
 * - Optional lightbox/modal
 */

@layer components {
  /* ============================================================================
     BASE GALLERY STYLES
     ============================================================================ */

  .gallery {
    --gallery-gap: var(--spacing-lg);
    --gallery-columns: 3;
    --gallery-min-width: 280px;
    --gallery-border-radius: var(--border-radius-lg);
    --gallery-transition: var(--transition-base);

    /* Overlay styles */
    --gallery-overlay-bg: rgb(0 0 0 / 0.6);
    --gallery-overlay-text: var(--color-white);

    /* Hover effects */
    --gallery-hover-transform: scale(1.05);
    --gallery-hover-shadow: var(--shadow-xl);

    width: 100%;
    max-width: var(--container-5xl);
    margin-inline: auto;
  }

  /* ============================================================================
     GALLERY HEADER (TITLE + DESCRIPTION)
     ============================================================================ */

  .gallery-header {
    text-align: center;
    margin-block-end: var(--spacing-3xl);
  }

  .gallery-title {
    margin: 0;
    margin-block-end: var(--spacing-sm);
    font-size: clamp(var(--font-size-2xl), 4vw, var(--font-size-3xl));
    font-weight: var(--font-weight-bold);
    color: var(--color-text);
    line-height: var(--line-height-tight);
  }

  .gallery-description {
    margin: 0;
    font-size: var(--font-size-lg);
    color: var(--color-text-muted);
    line-height: var(--line-height-normal);
    max-width: var(--container-2xl);
    margin-inline: auto;
  }

  /* ============================================================================
     GALLERY FILTERS (OPTIONAL CATEGORY FILTERING)
     ============================================================================ */

  .gallery-filters {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: var(--spacing-sm);
    margin-block-end: var(--spacing-2xl);
  }

  .gallery-filter {
    padding: var(--spacing-sm) var(--spacing-lg);
    font-family: var(--font-sans);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-medium);
    color: var(--color-text-muted);
    background: var(--color-surface);
    border: var(--border-width-thin) solid var(--color-border);
    border-radius: var(--border-radius-full);
    cursor: pointer;
    transition: all var(--gallery-transition);
  }

  .gallery-filter:hover {
    color: var(--color-text);
    border-color: var(--color-primary-500);
  }

  .gallery-filter:focus-visible {
    outline: 3px solid var(--color-border-focus);
    outline-offset: 2px;
  }

  .gallery-filter-active {
    color: var(--color-white);
    background: var(--color-primary-600);
    border-color: var(--color-primary-600);
  }

  .gallery-filter-active:hover {
    background: var(--color-primary-700);
    border-color: var(--color-primary-700);
  }

  /* ============================================================================
     GALLERY GRID (DEFAULT LAYOUT)
     ============================================================================ */

  .gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(var(--gallery-min-width), 1fr));
    gap: var(--gallery-gap);
  }

  /* 2-column layout */
  .gallery-columns-2 {
    --gallery-columns: 2;
    --gallery-min-width: 320px;
  }

  /* 3-column layout (default) */
  .gallery-columns-3 {
    --gallery-columns: 3;
    --gallery-min-width: 280px;
  }

  /* 4-column layout */
  .gallery-columns-4 {
    --gallery-columns: 4;
    --gallery-min-width: 240px;
  }

  /* ============================================================================
     MASONRY LAYOUT
     ============================================================================ */

  .gallery-masonry {
    display: grid;
    grid-template-columns: repeat(var(--gallery-columns), 1fr);
    grid-auto-rows: 20px;
    gap: var(--gallery-gap);
  }

  .gallery-masonry .gallery-item {
    /* Items will be positioned by JavaScript or CSS Grid masonry */
    break-inside: avoid;
  }

  /* CSS Masonry fallback using column-count (limited browser support) */
  @supports (grid-template-rows: masonry) {
    .gallery-masonry {
      grid-template-rows: masonry;
      grid-auto-rows: auto;
    }
  }

  /* Multi-column fallback for browsers without grid masonry */
  @supports not (grid-template-rows: masonry) {
    .gallery-masonry {
      column-count: var(--gallery-columns);
      column-gap: var(--gallery-gap);
      display: block;
    }

    .gallery-masonry .gallery-item {
      display: inline-block;
      width: 100%;
      margin-block-end: var(--gallery-gap);
    }
  }

  /* ============================================================================
     GALLERY ITEM
     ============================================================================ */

  .gallery-item {
    position: relative;
    overflow: hidden;
    border-radius: var(--gallery-border-radius);
    background: var(--color-surface);
  }

  /* Default variant - simple card with shadow */
  .gallery-default .gallery-item {
    border: var(--border-width-thin) solid var(--color-border);
    transition: all var(--gallery-transition);
  }

  .gallery-default .gallery-item:hover {
    box-shadow: var(--gallery-hover-shadow);
    transform: translateY(-4px);
  }

  /* Minimal variant - borderless */
  .gallery-minimal .gallery-item {
    border: none;
    background: transparent;
  }

  /* Cards variant - uses Card molecule */
  .gallery-cards .gallery-item {
    /* Styling handled by Card molecule */
    background: transparent;
    border: none;
  }

  /* ============================================================================
     GALLERY ITEM LINK (CLICKABLE)
     ============================================================================ */

  .gallery-item-link {
    display: block;
    color: inherit;
    text-decoration: none;
    cursor: pointer;
  }

  .gallery-item-link:focus-visible {
    outline: 3px solid var(--color-border-focus);
    outline-offset: 2px;
    border-radius: var(--gallery-border-radius);
  }

  /* ============================================================================
     GALLERY MEDIA (IMAGE CONTAINER)
     ============================================================================ */

  .gallery-media {
    position: relative;
    width: 100%;
    overflow: hidden;
    background: var(--color-gray-200);
  }

  /* Aspect ratio control */
  .gallery-media-square {
    aspect-ratio: 1 / 1;
  }

  .gallery-media-landscape {
    aspect-ratio: 16 / 9;
  }

  .gallery-media-portrait {
    aspect-ratio: 3 / 4;
  }

  .gallery-media-wide {
    aspect-ratio: 21 / 9;
  }

  .gallery-media-auto {
    aspect-ratio: auto;
  }

  /* ============================================================================
     GALLERY IMAGE
     ============================================================================ */

  .gallery-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--gallery-transition);
  }

  /* Image zoom on hover (default and minimal variants) */
  .gallery-default .gallery-item:hover .gallery-image,
  .gallery-minimal .gallery-item:hover .gallery-image {
    transform: var(--gallery-hover-transform);
  }

  /* ============================================================================
     GALLERY OVERLAY (APPEARS ON HOVER)
     ============================================================================ */

  .gallery-overlay-variant .gallery-media::after {
    content: '';
    position: absolute;
    inset: 0;
    background: var(--gallery-overlay-bg);
    opacity: 0;
    transition: opacity var(--gallery-transition);
    pointer-events: none;
  }

  .gallery-overlay-variant .gallery-item:hover .gallery-media::after {
    opacity: 1;
  }

  /* ============================================================================
     GALLERY CONTENT (TEXT/METADATA OVERLAY)
     ============================================================================ */

  .gallery-content {
    padding: var(--spacing-lg);
  }

  /* Overlay variant - content appears on hover */
  .gallery-overlay-variant .gallery-content {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: var(--spacing-xl);
    opacity: 0;
    transform: translateY(8px);
    transition: all var(--gallery-transition);
    z-index: 1;
    color: var(--gallery-overlay-text);
  }

  .gallery-overlay-variant .gallery-item:hover .gallery-content {
    opacity: 1;
    transform: translateY(0);
  }

  /* ============================================================================
     GALLERY TITLE & DESCRIPTION
     ============================================================================ */

  .gallery-item-title {
    margin: 0;
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: currentColor;
    line-height: var(--line-height-snug);
  }

  .gallery-overlay-variant .gallery-item-title {
    color: var(--gallery-overlay-text);
    margin-block-end: var(--spacing-xs);
  }

  .gallery-item-description {
    margin: 0;
    margin-block-start: var(--spacing-xs);
    font-size: var(--font-size-base);
    color: var(--color-text-muted);
    line-height: var(--line-height-normal);
  }

  .gallery-overlay-variant .gallery-item-description {
    color: var(--gallery-overlay-text);
    opacity: 0.9;
  }

  /* ============================================================================
     GALLERY CATEGORY/TAG
     ============================================================================ */

  .gallery-item-category {
    position: absolute;
    top: var(--spacing-md);
    left: var(--spacing-md);
    padding: var(--spacing-xs) var(--spacing-sm);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--color-white);
    background: var(--color-primary-600);
    border-radius: var(--border-radius-sm);
    z-index: 2;
  }

  /* ============================================================================
     GALLERY LOADING PLACEHOLDER
     ============================================================================ */

  .gallery-item-loading {
    display: flex;
    align-items: center;
    justify-content: center;
    min-block-size: 300px;
    background: var(--color-gray-100);
    color: var(--color-text-muted);
    font-size: var(--font-size-lg);
  }

  /* Skeleton animation for loading state */
  @keyframes gallery-skeleton-pulse {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }

  .gallery-item-loading {
    animation: gallery-skeleton-pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  /* ============================================================================
     GALLERY LIGHTBOX/MODAL (OPTIONAL)
     ============================================================================ */

  .gallery-lightbox {
    position: fixed;
    inset: 0;
    display: none;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-xl);
    background: rgb(0 0 0 / 0.9);
    z-index: var(--z-30);
    cursor: zoom-out;
  }

  .gallery-lightbox-open {
    display: flex;
  }

  .gallery-lightbox-image {
    max-width: 90vw;
    max-height: 90vh;
    object-fit: contain;
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-2xl);
  }

  .gallery-lightbox-close {
    position: absolute;
    top: var(--spacing-xl);
    right: var(--spacing-xl);
    padding: var(--spacing-md);
    font-size: var(--font-size-2xl);
    color: var(--color-white);
    background: transparent;
    border: none;
    cursor: pointer;
    transition: opacity var(--gallery-transition);
    z-index: 1;
  }

  .gallery-lightbox-close:hover {
    opacity: 0.7;
  }

  .gallery-lightbox-close:focus-visible {
    outline: 3px solid var(--color-white);
    outline-offset: 2px;
  }

  /* ============================================================================
     PAGINATION (OPTIONAL)
     ============================================================================ */

  .gallery-pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: var(--spacing-sm);
    margin-block-start: var(--spacing-3xl);
  }

  .gallery-pagination-button {
    padding: var(--spacing-sm) var(--spacing-lg);
    font-family: var(--font-sans);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-medium);
    color: var(--color-text);
    background: var(--color-surface);
    border: var(--border-width-thin) solid var(--color-border);
    border-radius: var(--border-radius-md);
    cursor: pointer;
    transition: all var(--gallery-transition);
    min-block-size: 44px;
    min-inline-size: 44px;
  }

  .gallery-pagination-button:hover:not(:disabled) {
    background: var(--color-primary-600);
    color: var(--color-white);
    border-color: var(--color-primary-600);
  }

  .gallery-pagination-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .gallery-pagination-button:focus-visible {
    outline: 3px solid var(--color-border-focus);
    outline-offset: 2px;
  }

  .gallery-pagination-active {
    background: var(--color-primary-600);
    color: var(--color-white);
    border-color: var(--color-primary-600);
  }

  /* ============================================================================
     DARK MODE
     ============================================================================ */

  @media (prefers-color-scheme: dark) {
    :root:not([data-theme="light"]) {
      --gallery-overlay-bg: rgb(0 0 0 / 0.8);
      .gallery-item-loading {
        background: var(--color-gray-800);
      }
      .gallery-media {
        background: var(--color-gray-700);
      }
    }
  }

  [data-theme="dark"] {
    --gallery-overlay-bg: rgb(0 0 0 / 0.8);
  }

  [data-theme="dark"] .gallery-item-loading {
    background: var(--color-gray-800);
  }

  [data-theme="dark"] .gallery-media {
    background: var(--color-gray-700);
  }

  /* ============================================================================
     RESPONSIVE DESIGN
     ============================================================================ */

  /* Tablet (2 columns max) */
  @media (max-width: 1024px) {
    .gallery-columns-4 {
      --gallery-columns: 3;
    }

    .gallery-masonry {
      --gallery-columns: 2;
    }
  }

  /* Mobile (1 column) */
  @media (max-width: 640px) {
    .gallery {
      --gallery-gap: var(--spacing-md);
    }

    .gallery-columns-2,
    .gallery-columns-3,
    .gallery-columns-4 {
      --gallery-columns: 1;
      --gallery-min-width: 100%;
    }

    .gallery-masonry {
      --gallery-columns: 1;
      column-count: 1;
    }

    .gallery-header {
      margin-block-end: var(--spacing-2xl);
      text-align: start;
    }

    .gallery-title {
      font-size: var(--font-size-2xl);
    }

    .gallery-description {
      font-size: var(--font-size-base);
    }

    .gallery-content {
      padding: var(--spacing-md);
    }

    .gallery-overlay-variant .gallery-content {
      padding: var(--spacing-lg);
    }

    .gallery-lightbox {
      padding: var(--spacing-md);
    }

    .gallery-lightbox-close {
      top: var(--spacing-md);
      right: var(--spacing-md);
    }
  }

  /* ============================================================================
     ACCESSIBILITY - REDUCED MOTION
     ============================================================================ */

  @media (prefers-reduced-motion: reduce) {
    .gallery-item,
    .gallery-image,
    .gallery-content,
    .gallery-media::after,
    .gallery-filter,
    .gallery-pagination-button {
      transition: none;
    }

    .gallery-item-loading {
      animation: none;
    }
  }

  /* ============================================================================
     PRINT STYLES
     ============================================================================ */

  @media print {
    .gallery {
      max-width: 100%;
    }

    .gallery-grid,
    .gallery-masonry {
      display: block;
    }

    .gallery-item {
      page-break-inside: avoid;
      margin-block-end: var(--spacing-lg);
      break-inside: avoid;
    }

    .gallery-filters,
    .gallery-pagination,
    .gallery-lightbox {
      display: none !important;
    }

    /* Show all content in overlay variant */
    .gallery-overlay-variant .gallery-content {
      position: static;
      opacity: 1;
      transform: none;
      color: var(--color-text);
    }

    .gallery-overlay-variant .gallery-media::after {
      display: none;
    }
  }
}
