/**
 * Stat Molecule Component
 *
 * Description: Displays statistical data with large numbers, labels, icons, and trend indicators.
 * Commonly used in hero sections and feature areas to showcase metrics, KPIs, and social proof.
 *
 * Dependencies:
 *   - Icon Atom (components/atoms/icon/)
 *   - Design tokens (components/_system/tokens.css)
 *
 * Marketing Patterns:
 *   - Large number display for immediate impact
 *   - Optional icon for visual interest and context
 *   - Trend indicators (up/down) for growth metrics
 *   - Comparison text for competitive positioning
 *   - Horizontal grouping for dashboard-style layouts
 *   - Count-up animation support (via data-count-to attribute)
 *
 * Real-World Usage:
 *   - Stripe: "Millions of companies | 135+ countries | 99.99% uptime"
 *   - Notion: "20M+ users | 50 employees | 100+ countries"
 *   - Linear: Count-up animation on growth metrics
 *
 * Variants:
 *   - Default: Vertical stack with icon, number, label
 *   - Inline: Horizontal layout for compact displays
 *   - Card: Elevated card with padding and shadow
 *   - Featured: Highlighted stat with accent background
 *
 * Size Variants:
 *   - sm: Compact stats for dense layouts
 *   - md: Default size for most use cases
 *   - lg: Larger stats for emphasis
 *   - xl: Hero-sized stats for maximum impact
 *
 * Accessibility:
 *   - Semantic HTML structure
 *   - Proper color contrast (WCAG AA)
 *   - Screen reader friendly labels
 *   - Icons marked as decorative when appropriate
 */

@layer components {
  /* ========================================================================
     Base Stat Styles
     ======================================================================== */

  .stat {
    /* CSS Variables for easy customization */
    --stat-gap: var(--spacing-sm);
    --stat-value-size: var(--font-size-3xl);
    --stat-label-size: var(--font-size-base);
    --stat-icon-size: 2.5rem;

    /* Layout */
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--stat-gap);
    text-align: center;

    /* Ensure stat takes full width in grid/flex containers */
    width: 100%;
  }

  /* ========================================================================
     Icon Styles
     ======================================================================== */

  .stat-icon {
    display: flex;
    justify-content: center;
    align-items: center;
    color: var(--color-primary-600);
    flex-shrink: 0;
  }

  .stat-icon .icon {
    width: var(--stat-icon-size);
    height: var(--stat-icon-size);
  }

  /* ========================================================================
     Value Display (Number)
     ======================================================================== */

  .stat-value-wrapper {
    display: flex;
    align-items: baseline;
    justify-content: center;
    gap: 0.125em;
    flex-wrap: wrap;
  }

  .stat-value {
    font-size: var(--stat-value-size);
    font-weight: var(--font-weight-bold);
    line-height: var(--line-height-tight);
    color: var(--color-text);
    letter-spacing: -0.02em; /* Tighter letter spacing for large numbers */

    /* Tabular numbers for better alignment */
    font-variant-numeric: tabular-nums;
  }

  /* Prefix and suffix (e.g., $, +, %, /mo) */
  .stat-prefix,
  .stat-suffix {
    font-size: 0.6em;
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-muted);
    line-height: var(--line-height-tight);
  }

  /* ========================================================================
     Label (Description)
     ======================================================================== */

  .stat-label {
    font-size: var(--stat-label-size);
    font-weight: var(--font-weight-medium);
    color: var(--color-text-muted);
    line-height: var(--line-height-snug);
  }

  /* ========================================================================
     Trend Indicator (Up/Down Arrow with Percentage)
     ======================================================================== */

  .stat-trend {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-xs);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
  }

  /* Trend direction colors */
  .stat-trend-up {
    color: var(--color-success);
  }

  .stat-trend-down {
    color: var(--color-error);
  }

  .stat-trend-neutral {
    color: var(--color-text-muted);
  }

  .stat-trend-icon {
    width: 1rem;
    height: 1rem;
    flex-shrink: 0;
  }

  .stat-trend-value {
    font-weight: var(--font-weight-semibold);
  }

  .stat-trend-label {
    color: var(--color-text-muted);
    font-weight: var(--font-weight-normal);
  }

  /* ========================================================================
     Comparison Text (Competitive Positioning)
     ======================================================================== */

  .stat-comparison {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
    line-height: var(--line-height-snug);
    font-style: italic;
  }

  /* ========================================================================
     Variant: Inline (Horizontal Layout)
     ======================================================================== */

  .stat-inline {
    flex-direction: row;
    align-items: center;
    text-align: left;
    gap: var(--spacing-md);
  }

  .stat-inline .stat-value-wrapper {
    order: 1;
  }

  .stat-inline .stat-label {
    order: 2;
    text-align: left;
  }

  .stat-inline .stat-icon {
    order: 0;
  }

  /* ========================================================================
     Variant: Card (Elevated Container)
     ======================================================================== */

  .stat-card {
    padding: var(--spacing-lg);
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-sm);
    transition: var(--transition-all);
  }

  .stat-card:hover {
    box-shadow: var(--shadow-md);
    transform: translateY(-2px);
  }

  /* ========================================================================
     Variant: Featured (Accent Background)
     ======================================================================== */

  .stat-featured {
    padding: var(--spacing-xl);
    background: linear-gradient(135deg, var(--color-primary-50) 0%, var(--color-primary-100) 100%);
    border: 2px solid var(--color-primary-200);
    border-radius: var(--border-radius-xl);
  }

  .stat-featured .stat-value {
    color: var(--color-primary-700);
  }

  .stat-featured .stat-icon {
    color: var(--color-primary-600);
  }

  /* ========================================================================
     Color Variants (Number Color)
     ======================================================================== */

  .stat-primary .stat-value {
    color: var(--color-primary-600);
  }

  .stat-secondary .stat-value {
    color: var(--color-secondary-600);
  }

  .stat-success .stat-value {
    color: var(--color-success);
  }

  .stat-gradient .stat-value {
    background: linear-gradient(135deg, var(--color-primary-600) 0%, var(--color-secondary-600) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  /* ========================================================================
     Size Variants
     ======================================================================== */

  /* Small: Compact stats for sidebars or dense layouts */
  .stat-sm {
    --stat-value-size: var(--font-size-xl);
    --stat-label-size: var(--font-size-sm);
    --stat-icon-size: 1.5rem;
    --stat-gap: var(--spacing-xs);
  }

  /* Large: Emphasized stats for key metrics */
  .stat-lg {
    --stat-value-size: var(--font-size-4xl);
    --stat-label-size: var(--font-size-lg);
    --stat-icon-size: 3rem;
    --stat-gap: var(--spacing-md);
  }

  /* Extra Large: Hero section stats */
  .stat-xl {
    --stat-value-size: var(--font-size-5xl);
    --stat-label-size: var(--font-size-xl);
    --stat-icon-size: 4rem;
    --stat-gap: var(--spacing-lg);
  }

  /* ========================================================================
     Horizontal Group (Multiple Stats in Row)
     ======================================================================== */

  .stat-group {
    display: grid;
    gap: var(--spacing-xl);

    /* Default: Single column on mobile */
    grid-template-columns: 1fr;
  }

  /* Two columns on tablets */
  @media (min-width: 48em) {
    .stat-group {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  /* Three or four columns on desktop */
  @media (min-width: 64em) {
    .stat-group {
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }

    /* Explicit column count modifiers */
    .stat-group-3 {
      grid-template-columns: repeat(3, 1fr);
    }

    .stat-group-4 {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  /* Dividers between stats in horizontal layout */
  .stat-group-dividers {
    gap: 0;
  }

  .stat-group-dividers .stat {
    padding: var(--spacing-lg);
    border-right: 1px solid var(--color-border);
  }

  .stat-group-dividers .stat:last-child {
    border-right: none;
  }

  /* Mobile: Stack with horizontal dividers */
  @media (max-width: 47.99em) {
    .stat-group-dividers .stat {
      border-right: none;
      border-bottom: 1px solid var(--color-border);
    }

    .stat-group-dividers .stat:last-child {
      border-bottom: none;
    }
  }

  /* ========================================================================
     Count-Up Animation Support
     ======================================================================== */

  /* Data attribute [data-count-to] enables JavaScript count-up animation */
  .stat-value[data-count-to] {
    /* Animation will be handled by JavaScript */
    /* Initial state: Show 0 or loading state */
  }

  /* Optional: Animate number changes */
  @media (prefers-reduced-motion: no-preference) {
    .stat-value {
      transition: all var(--transition-base);
    }
  }

  /* ========================================================================
     Dark Mode
     ======================================================================== */

  @media (prefers-color-scheme: dark) {
    :root:not([data-theme="light"]) .stat-card {
      background-color: var(--color-gray-800);
      border-color: var(--color-gray-700);
    }

    :root:not([data-theme="light"]) .stat-featured {
      background: linear-gradient(135deg, var(--color-primary-900) 0%, var(--color-primary-800) 100%);
      border-color: var(--color-primary-700);
    }

    :root:not([data-theme="light"]) .stat-featured .stat-value {
      color: var(--color-primary-300);
    }

    :root:not([data-theme="light"]) .stat-featured .stat-icon {
      color: var(--color-primary-400);
    }
  }

  [data-theme="dark"] .stat-card {
    background-color: var(--color-gray-800);
    border-color: var(--color-gray-700);
  }

  [data-theme="dark"] .stat-featured {
    background: linear-gradient(135deg, var(--color-primary-900) 0%, var(--color-primary-800) 100%);
    border-color: var(--color-primary-700);
  }

  [data-theme="dark"] .stat-featured .stat-value {
    color: var(--color-primary-300);
  }

  [data-theme="dark"] .stat-featured .stat-icon {
    color: var(--color-primary-400);
  }

  /* ========================================================================
     Accessibility Enhancements
     ======================================================================== */

  /* High contrast mode support */
  @media (prefers-contrast: high) {
    .stat-card {
      border-width: 2px;
    }

    .stat-trend-up,
    .stat-trend-down {
      font-weight: var(--font-weight-bold);
    }
  }

  /* Reduced motion: Disable animations */
  @media (prefers-reduced-motion: reduce) {
    .stat,
    .stat-value,
    .stat-card {
      transition: none;
    }

    .stat-card:hover {
      transform: none;
    }
  }
}
