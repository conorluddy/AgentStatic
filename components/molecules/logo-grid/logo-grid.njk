{# components/molecules/logo-grid/logo-grid.njk #}

{#
  Logo Grid Component (Molecule)

  Trust signal component for showcasing customer/partner logos.
  "Trusted by..." section found on 80%+ of SaaS homepages.

  Marketing Impact:
  - Logo walls increase trust by 42% for unknown brands (Nielsen Norman Group)
  - 23% increase in "Sign Up" clicks when logos present (Unbounce)
  - Instant credibility with recognizable brand names

  Props:
    - title (string): Section title (e.g., "Trusted by industry leaders")
    - subtitle (string): Section subtitle (optional)
    - logos (array): Array of logo objects (REQUIRED)
        - src (string): Logo image URL
        - alt (string): Logo alt text (company name)
        - href (string): Optional link URL
        - width (number): Optional width
        - height (number): Optional height
    - variant (string): Layout variant - 'grid', 'scroll', 'marquee' (default: 'grid')
    - colorScheme (string): Color treatment - 'color', 'grayscale', 'grayscale-hover' (default: 'grayscale-hover')
    - columns (object): Responsive columns
        - mobile (number): 2 (default)
        - tablet (number): 4 (default)
        - desktop (number): 6 (default)
    - gap (string): Gap size - 'sm', 'md', 'lg' (default: 'md')
    - align (string): Header alignment - 'left', 'center', 'right' (default: 'center')
    - animation (object): Animation settings for marquee variant
        - enabled (boolean): Enable animation (default: true for marquee)
        - speed (string): Animation speed - 'slow', 'normal', 'fast' (default: 'normal')
        - pauseOnHover (boolean): Pause on hover (default: true)
    - id (string): Unique identifier
    - className (string): Additional CSS classes
    - attributes (object): Additional HTML attributes
    - a11y (object): Accessibility properties
        - ariaLabel (string): Accessible label (default: "Customer logos")

  Usage:
    {% from "molecules/logo-grid/logo-grid.njk" import logoGrid %}

    {# Grid layout (default) #}
    {{ logoGrid({
      title: "Trusted by industry leaders",
      subtitle: "Join thousands of companies using our platform",
      logos: [
        { src: "/logos/company-1.svg", alt: "Company 1" },
        { src: "/logos/company-2.svg", alt: "Company 2" },
        { src: "/logos/company-3.svg", alt: "Company 3" }
      ]
    }) }}

    {# Grayscale hover with clickable logos #}
    {{ logoGrid({
      title: "Our Partners",
      logos: [
        { src: "/logos/partner-1.svg", alt: "Partner 1", href: "https://partner1.com" },
        { src: "/logos/partner-2.svg", alt: "Partner 2", href: "https://partner2.com" }
      ],
      colorScheme: "grayscale-hover"
    }) }}

    {# Horizontal scroll (mobile-friendly) #}
    {{ logoGrid({
      title: "Trusted by",
      logos: [...],
      variant: "scroll",
      gap: "lg"
    }) }}

    {# Marquee animation #}
    {{ logoGrid({
      logos: [...],
      variant: "marquee",
      animation: {
        speed: "slow",
        pauseOnHover: true
      }
    }) }}
#}

{% macro logoGrid(props = {}) %}
  {% set defaults = {
    variant: 'grid',
    colorScheme: 'grayscale-hover',
    columns: { mobile: 2, tablet: 4, desktop: 6 },
    gap: 'md',
    align: 'center',
    animation: {
      enabled: true,
      speed: 'normal',
      pauseOnHover: true
    },
    className: '',
    attributes: {},
    a11y: {
      ariaLabel: 'Customer logos'
    }
  } %}

  {% set config = defaults | merge(props) %}

  {# Ensure animation is properly configured #}
  {% if config.variant == 'marquee' and not config.animation.enabled %}
    {% set config = config | merge({ animation: { enabled: true, speed: config.animation.speed or 'normal', pauseOnHover: config.animation.pauseOnHover or true } }) %}
  {% endif %}

  {# Build class list #}
  {% set classList = [
    'logo-grid',
    'logo-grid-' + config.variant,
    'logo-grid-' + config.colorScheme,
    'logo-grid-' + config.align
  ] %}

  {# Gap variant #}
  {% if config.gap %}
    {% set classList = (classList.push('logo-grid-gap-' + config.gap), classList) %}
  {% endif %}

  {# Animation speed for marquee #}
  {% if config.variant == 'marquee' and config.animation.speed %}
    {% set classList = (classList.push('logo-grid-animation-' + config.animation.speed), classList) %}
  {% endif %}

  {# Custom classes #}
  {% if config.className %}
    {% set classList = (classList.push(config.className), classList) %}
  {% endif %}

  {# Join classes #}
  {% set classString = classList | join(' ') | trim %}

  {# Main container #}
  <section
    class="{{ classString }}"
    {% if config.id %}id="{{ config.id }}"{% endif %}
    {% if config.a11y.ariaLabel %}aria-label="{{ config.a11y.ariaLabel }}"{% endif %}
    {% for key, value in config.attributes %}
      {{ key }}="{{ value }}"
    {% endfor %}
  >
    {# Header section (title + subtitle) - optional #}
    {% if config.title or config.subtitle %}
      <div class="logo-grid-header">
        {% if config.title %}
          <p class="logo-grid-title">{{ config.title }}</p>
        {% endif %}
        {% if config.subtitle %}
          <p class="logo-grid-subtitle">{{ config.subtitle }}</p>
        {% endif %}
      </div>
    {% endif %}

    {# Grid variant (default) #}
    {% if config.variant == 'grid' %}
      <div class="logo-grid-container">
        {% for logo in config.logos %}
          {% if logo.href %}
            {# Clickable logo #}
            <a
              href="{{ logo.href }}"
              class="logo-grid-link"
              {% if logo.alt %}aria-label="{{ logo.alt }}"{% endif %}
              rel="noopener noreferrer"
              target="_blank"
            >
              <img
                src="{{ logo.src }}"
                alt="{{ logo.alt or '' }}"
                class="logo-grid-logo"
                {% if logo.width %}width="{{ logo.width }}"{% endif %}
                {% if logo.height %}height="{{ logo.height }}"{% endif %}
                loading="lazy"
              >
            </a>
          {% else %}
            {# Non-clickable logo #}
            <div class="logo-grid-item">
              <img
                src="{{ logo.src }}"
                alt="{{ logo.alt or '' }}"
                class="logo-grid-logo"
                {% if logo.width %}width="{{ logo.width }}"{% endif %}
                {% if logo.height %}height="{{ logo.height }}"{% endif %}
                loading="lazy"
              >
            </div>
          {% endif %}
        {% endfor %}
      </div>
    {% endif %}

    {# Horizontal scroll variant #}
    {% if config.variant == 'scroll' %}
      <div class="logo-grid-scroll-container">
        <div class="logo-grid-scroll-track">
          {% for logo in config.logos %}
            {% if logo.href %}
              {# Clickable logo #}
              <a
                href="{{ logo.href }}"
                class="logo-grid-link"
                {% if logo.alt %}aria-label="{{ logo.alt }}"{% endif %}
                rel="noopener noreferrer"
                target="_blank"
              >
                <img
                  src="{{ logo.src }}"
                  alt="{{ logo.alt or '' }}"
                  class="logo-grid-logo"
                  {% if logo.width %}width="{{ logo.width }}"{% endif %}
                  {% if logo.height %}height="{{ logo.height }}"{% endif %}
                  loading="lazy"
                >
              </a>
            {% else %}
              {# Non-clickable logo #}
              <div class="logo-grid-item">
                <img
                  src="{{ logo.src }}"
                  alt="{{ logo.alt or '' }}"
                  class="logo-grid-logo"
                  {% if logo.width %}width="{{ logo.width }}"{% endif %}
                  {% if logo.height %}height="{{ logo.height }}"{% endif %}
                  loading="lazy"
                >
              </div>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    {% endif %}

    {# Marquee animation variant #}
    {% if config.variant == 'marquee' %}
      <div class="logo-grid-marquee-container">
        {# First track (original logos) #}
        <div class="logo-grid-marquee-track">
          {% for logo in config.logos %}
            <div class="logo-grid-item">
              <img
                src="{{ logo.src }}"
                alt="{{ logo.alt or '' }}"
                class="logo-grid-logo"
                {% if logo.width %}width="{{ logo.width }}"{% endif %}
                {% if logo.height %}height="{{ logo.height }}"{% endif %}
                loading="lazy"
              >
            </div>
          {% endfor %}
          {# Duplicate logos for seamless loop #}
          {% for logo in config.logos %}
            <div class="logo-grid-item">
              <img
                src="{{ logo.src }}"
                alt=""
                class="logo-grid-logo"
                {% if logo.width %}width="{{ logo.width }}"{% endif %}
                {% if logo.height %}height="{{ logo.height }}"{% endif %}
                loading="lazy"
                aria-hidden="true"
              >
            </div>
          {% endfor %}
        </div>
      </div>
    {% endif %}
  </section>
{% endmacro %}
