<!-- components/molecules/feature-list/feature-list.njk -->

{#
  Feature List Component (Molecule)

  Description: List of features with icons and text. Used in pricing tables,
  product descriptions, and feature comparison sections. Supports multiple
  layout options, density variants, and mixed check/cross icons.

  Props:
    - items (array, required): Array of feature objects
      Each item has:
        - text (string): Feature description
        - icon (string): Icon name (default: uses defaultIcon)
        - included (boolean): Whether feature is included (default: true)
    - iconPosition (string): Icon alignment - 'left', 'top' (default: 'left')
    - density (string): Spacing density - 'compact', 'normal', 'spacious' (default: 'normal')
    - columns (number): Number of columns - 1 or 2 (default: 1)
    - defaultIcon (string): Default icon for items without explicit icon (default: 'check')
    - className (string): Additional CSS classes
    - id (string): Unique identifier
    - attributes (object): Additional HTML attributes
    - a11y (object): Accessibility properties
      - ariaLabel (string): Accessible label for the list

  Usage:
    {% from "molecules/feature-list/feature-list.njk" import featureList %}

    <!-- Basic feature list with checkmarks -->
    {{ featureList({
      items: [
        { text: 'Unlimited users' },
        { text: '24/7 support' },
        { text: 'Custom domain' }
      ]
    }) }}

    <!-- Comparison list with mixed check/cross icons -->
    {{ featureList({
      items: [
        { text: 'Unlimited users', icon: 'check' },
        { text: '24/7 support', icon: 'check' },
        { text: 'Custom domain', icon: 'x', included: false }
      ]
    }) }}

    <!-- Two-column compact layout -->
    {{ featureList({
      items: [...],
      columns: 2,
      density: 'compact'
    }) }}

    <!-- Top-aligned icons for longer descriptions -->
    {{ featureList({
      items: [...],
      iconPosition: 'top'
    }) }}
#}

{% from "atoms/icon/icon.njk" import icon %}
{% from "atoms/text/text.njk" import text %}

{% macro featureList(props = {}) %}
  {% set defaults = {
    items: [],
    iconPosition: 'left',
    density: 'normal',
    columns: 1,
    defaultIcon: 'check',
    className: '',
    attributes: {},
    a11y: {}
  } %}

  {% set config = defaults | merge(props) %}

  <!-- Build class list -->
  {% set classList = ['feature-list'] %}

  <!-- Add icon position class -->
  {% if config.iconPosition == 'top' %}
    {% set classList = (classList.push('feature-list-top'), classList) %}
  {% endif %}

  <!-- Add density class -->
  {% if config.density == 'compact' %}
    {% set classList = (classList.push('feature-list-compact'), classList) %}
  {% elif config.density == 'spacious' %}
    {% set classList = (classList.push('feature-list-spacious'), classList) %}
  {% endif %}

  <!-- Add columns class -->
  {% if config.columns == 2 %}
    {% set classList = (classList.push('feature-list-two-column'), classList) %}
  {% endif %}

  <!-- Add custom classes -->
  {% if config.className %}
    {% set classList = (classList.push(config.className), classList) %}
  {% endif %}

  <!-- Render semantic list -->
  <ul
    class="{{ classList | join(' ') }}"
    {% if config.id %}id="{{ config.id }}"{% endif %}
    {% if config.a11y.ariaLabel %}aria-label="{{ config.a11y.ariaLabel }}"{% endif %}
    {% for key, value in config.attributes %}
      {{ key }}="{{ value }}"
    {% endfor %}
  >
    {% for item in config.items %}
      {% set itemDefaults = {
        icon: config.defaultIcon,
        text: '',
        included: true
      } %}
      {% set itemConfig = itemDefaults | merge(item) %}

      <!-- Build item class list -->
      {% set itemClassList = ['feature-list-item'] %}
      {% if itemConfig.included %}
        {% set itemClassList = (itemClassList.push('feature-list-item-included'), itemClassList) %}
      {% else %}
        {% set itemClassList = (itemClassList.push('feature-list-item-not-included'), itemClassList) %}
      {% endif %}

      {% set iconColor = '' %}
      {% if itemConfig.included and (itemConfig.icon == 'check' or itemConfig.icon == 'verified') %}
        {% set iconColor = 'success' %}
      {% elif not itemConfig.included and itemConfig.icon == 'x' %}
        {% set iconColor = 'error' %}
      {% endif %}

      <li class="{{ itemClassList | join(' ') }}">
        <!-- Icon -->
        <span class="feature-list-icon">
          {{ icon({
            name: itemConfig.icon,
            size: 'sm',
            color: iconColor,
            decorative: true
          }) }}
        </span>

        <!-- Text -->
        <span class="feature-list-text">
          {{ text({
            content: itemConfig.text,
            element: 'span',
            size: 'base'
          }) }}
        </span>
      </li>
    {% endfor %}
  </ul>
{% endmacro %}
