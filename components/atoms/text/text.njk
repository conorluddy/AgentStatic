<!-- components/atoms/text/text.njk -->

{#
  Text Atom Component

  Description: Flexible text component for paragraphs, spans, and inline elements
  with support for multiple sizes, weights, colors, and special formatting.

  Props:
    - content (string): Text content (supports HTML)
    - element (string): HTML element - 'p', 'span', 'div' (default: 'p')
    - size (string): Size variant - 'xs', 'sm', 'base', 'lg', 'xl', '2xl' (default: 'base')
    - weight (string): Font weight - 'light', 'normal', 'medium', 'semibold', 'bold' (default: 'normal')
    - color (string): Color variant - 'default', 'muted', 'primary', 'secondary', 'error', 'success' (default: 'default')
    - align (string): Text alignment - 'left', 'center', 'right', 'justify' (default: 'left')
    - lineHeight (string): Line height - 'tight', 'snug', 'normal', 'relaxed', 'loose' (default: 'normal')
    - lead (boolean): Lead paragraph styling (larger, more spacious)
    - readable (boolean): Apply max-width for optimal reading length (default: false)
    - truncate (boolean): Truncate text with ellipsis (default: false)
    - className (string): Additional CSS classes
    - id (string): Unique identifier for the component
    - attributes (object): Additional HTML attributes
    - a11y (object): Accessibility properties
      - ariaLabel (string): Accessible label
      - ariaDescribedBy (string): ID of describing element
      - role (string): ARIA role override

  Usage:
    {% from "atoms/text/text.njk" import text %}

    <!-- Basic paragraph -->
    {{ text({ content: 'This is body text.' }) }}

    <!-- Lead paragraph -->
    {{ text({
      content: 'This is a lead paragraph with emphasis.',
      lead: true
    }) }}

    <!-- Colored text with custom weight -->
    {{ text({
      content: 'Important message',
      color: 'primary',
      weight: 'semibold',
      size: 'lg'
    }) }}

    <!-- Inline span with custom styling -->
    <p>This is normal text {{ text({ content: 'with an inline span', element: 'span', color: 'muted' }) }}</p>

    <!-- Text with inline code -->
    {{ text({ content: 'Use the <code>text</code> component for body copy.' }) }}

    <!-- Centered text -->
    {{ text({
      content: 'Centered text',
      align: 'center',
      size: 'xl',
      weight: 'bold'
    }) }}
#}

{% macro text(props = {}) %}
  {% set defaults = {
    element: 'p',
    size: 'base',
    weight: 'normal',
    color: 'default',
    align: 'left',
    lineHeight: 'normal',
    lead: false,
    readable: false,
    truncate: false,
    className: '',
    attributes: {},
    a11y: {}
  } %}

  {% set config = defaults | merge(props) %}

  <!-- Build class list -->
  {% set classList = [
    'text',
    'text-' + config.size if config.size != 'base',
    'text-' + config.weight if config.weight != 'normal',
    'text-' + config.color if config.color != 'default',
    'text-' + config.align if config.align != 'left',
    'text-' + config.lineHeight if config.lineHeight != 'normal',
    'text-lead' if config.lead,
    'text-readable' if config.readable,
    'text-truncate' if config.truncate,
    config.className
  ] | reject('equalto', false) | join(' ') | trim %}

  <!-- Render the appropriate element -->
  {% if config.element == 'p' %}
    <p
      class="{{ classList }}"
      {% if config.id %}id="{{ config.id }}"{% endif %}
      {% if config.a11y.role %}role="{{ config.a11y.role }}"{% endif %}
      {% if config.a11y.ariaLabel %}aria-label="{{ config.a11y.ariaLabel }}"{% endif %}
      {% if config.a11y.ariaDescribedBy %}aria-describedby="{{ config.a11y.ariaDescribedBy }}"{% endif %}
      {% for key, value in config.attributes %}
        {{ key }}="{{ value }}"
      {% endfor %}
    >
      {{ config.content | safe if config.content }}
      {{ caller() if caller }}
    </p>
  {% elif config.element == 'span' %}
    <span
      class="{{ classList }}"
      {% if config.id %}id="{{ config.id }}"{% endif %}
      {% if config.a11y.role %}role="{{ config.a11y.role }}"{% endif %}
      {% if config.a11y.ariaLabel %}aria-label="{{ config.a11y.ariaLabel }}"{% endif %}
      {% if config.a11y.ariaDescribedBy %}aria-describedby="{{ config.a11y.ariaDescribedBy }}"{% endif %}
      {% for key, value in config.attributes %}
        {{ key }}="{{ value }}"
      {% endfor %}
    >
      {{ config.content | safe if config.content }}
      {{ caller() if caller }}
    </span>
  {% elif config.element == 'div' %}
    <div
      class="{{ classList }}"
      {% if config.id %}id="{{ config.id }}"{% endif %}
      {% if config.a11y.role %}role="{{ config.a11y.role }}"{% endif %}
      {% if config.a11y.ariaLabel %}aria-label="{{ config.a11y.ariaLabel }}"{% endif %}
      {% if config.a11y.ariaDescribedBy %}aria-describedby="{{ config.a11y.ariaDescribedBy }}"{% endif %}
      {% for key, value in config.attributes %}
        {{ key }}="{{ value }}"
      {% endfor %}
    >
      {{ config.content | safe if config.content }}
      {{ caller() if caller }}
    </div>
  {% endif %}
{% endmacro %}
